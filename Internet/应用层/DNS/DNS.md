# DNSæ¦‚è¿°
`DNS`ï¼Œ`Domain Name System`.åŸŸåç³»ç»Ÿï¼šæ˜¯`Internet`ä½¿ç”¨çš„å‘½åç³»ç»Ÿï¼Œæ¥å°†ä¾¿äºäººç±»è®°å¿†çš„åŸŸåè½¬æ¢ä¸º`IP`åœ°å€ã€‚

æ—©åœ¨`ARPANET`æ—¶ä»£ï¼Œæ•´ä¸ªç½‘ç»œä¸Šåªæœ‰æ•°ç™¾å°è®¡ç®—æœºï¼Œé‚£æ—¶å€™åªä½¿ç”¨ä¸€ä¸ª`hosts`çš„æ–‡ä»¶ï¼ŒæŠŠæ‰€æœ‰çš„ä¸»æœºåå­—å’Œç›¸åº”çš„`ip`éƒ½åˆ—å‡ºæ¥ï¼Œåªè¦ç”¨æˆ·è¾“å…¥ä¸€å°ä¸»æœºçš„åå­—ï¼Œè®¡ç®—æœºå°±èƒ½å¤Ÿå¾ˆå¿«å¾—åˆ°å¯¹åº”çš„`ip`ã€‚

å…¶å®ç°åœ¨ç†è®ºä¸Šä¹Ÿèƒ½æŠŠæ•´ä¸ªäº’è”ç½‘çš„æ‰€æœ‰ä¸»æœºåä»¥åŠå…¶å¯¹åº”çš„`ip`éƒ½æ”¾åˆ°åŒä¸€å°åŸŸåæœåŠ¡å™¨ä¸­ï¼Œä½†æ˜¯å› ä¸ºäº’è”ç½‘çš„è§„æ¨¡å¾ˆå¤§ï¼ŒåŸŸåæœåŠ¡å™¨è‚¯å®šä¼šå› ä¸ºè´Ÿè·è€Œæ— æ³•æ­£å¸¸å·¥ä½œï¼Œè€Œä¸”ä¸€æ—¦è¿™å°æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œé‚£æ•´ä¸ªäº’è”ç½‘å°±æŒ‚äº†ã€‚æ‰€ä»¥1983å¹´å°±å¼€å§‹é‡‡ç”¨**å±‚æ¬¡æ ‘çŠ¶ç»“æ„**çš„å‘½åæ–¹æ³•ï¼Œå¹¶ä½¿ç”¨*åˆ†å¸ƒå¼çš„åŸŸåç³»ç»ŸDNS*ã€‚

## ä¸ºä»€ä¹ˆè®¡ç®—æœºåœ¨å¤„ç†ipæ•°æ®æŠ¥æ—¶è¦ä½¿ç”¨ipåœ°å€ï¼Œè€Œä¸æ˜¯ç›´æ¥ç”¨åŸŸåå‘¢ï¼Ÿ
å› ä¸ºåŸŸåé•¿åº¦ä¸æ˜¯å›ºå®šçš„ï¼Œæœºå™¨å¤„ç†æ¯”è¾ƒå›°éš¾ã€‚`ip`åœ°å€æ˜¯å›ºå®šçš„`32bit`ï¼Œ`IPv6 128bit`ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œä¾¿äºè®¡ç®—æœºå¤„ç†ã€‚

## åŸŸåæœåŠ¡å™¨
åŸŸååˆ°`IP`åœ°å€çš„è§£ææ˜¯ç”±åˆ†å¸ƒåœ¨äº’è”ç½‘ä¸Šçš„è®¸å¤šåŸŸåæœåŠ¡å™¨ç¨‹åºå…±åŒå®Œæˆçš„ï¼Œè¿è¡ŒåŸŸåæœåŠ¡å™¨ç¨‹åºçš„ä¸»æœºå°±ç§°ä¸º**åŸŸåæœåŠ¡å™¨**ã€‚

åŸŸååˆ°ipçš„è§£æè¿‡ç¨‹ï¼ˆå¤§æ¦‚æµç¨‹ï¼‰ï¼š
+ æŸä¸ªåº”ç”¨è¿›ç¨‹éœ€è¦è§£æä¸»æœºåæ—¶ï¼Œè¯¥åº”ç”¨è¿›ç¨‹å°±è°ƒç”¨è§£æç¨‹åºï¼Œè¯¥åº”ç”¨è¿›ç¨‹æˆä¸ºä¸€ä¸ªDNSçš„clientï¼ŒæŠŠè¦è§£æçš„åŸŸåæ”¾å…¥DNSè¯·æ±‚æŠ¥æ–‡ä¸­ï¼ˆä»¥UDPæ•°æ®æŠ¥æ–¹å¼å‘é€ç»™**æœ¬åœ°åŸŸåæœåŠ¡å™¨**ï¼‰ã€‚
+ æœ¬åœ°åŸŸåæœåŠ¡å™¨åœ¨æŸ¥æ‰¾åŸŸååï¼Œå°†å¯¹åº”çš„IPåœ°å€æ”¾åœ¨å›ç­”æŠ¥æ–‡ä¸­è¿”å›ã€‚
+ åº”ç”¨è¿›ç¨‹è·å¾—ipåå³å¯è¿›è¡Œé€šä¿¡ã€‚

# åŸŸåç»“æ„
åŸŸåæ˜¯æŒ‰ç…§**å±‚æ¬¡æ ‘çŠ¶ç»“æ„**æ¥å‘½åçš„ã€‚ä»»ä½•ä¸€ä¸ªäº’è”ç½‘ä¸Šçš„ä¸»æœºã€è·¯ç”±å™¨éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„å±‚æ¬¡ç»“æ„çš„åå­—â€”â€”â€”â€”åŸŸåã€‚

åŸŸï¼Œæ˜¯åå­—ç©ºé—´ä¸­ä¸€ä¸ªå¯ä»¥è¢«ç®¡ç†çš„åˆ’åˆ†ã€‚åŸŸå¯ä»¥åˆ’åˆ†å­åŸŸï¼Œå­åŸŸåˆèƒ½åˆ’åˆ†å­åŸŸçš„å­åŸŸã€‚è¿™æ ·å°±å½¢æˆäº†é¡¶çº§åŸŸã€äºŒçº§åŸŸã€ä¸‰çº§åŸŸç­‰ã€‚

ä»è¯­æ³•è®²ï¼Œæ¯ä¸ªåŸŸåéƒ½ç”±æ ‡å·åºåˆ—ç»„æˆï¼Œæ ‡å·åºåˆ—ä¹‹é—´ä½¿ç”¨ `.` éš”å¼€ï¼š
```
www.hao123.com
```
> `com` æ˜¯é¡¶çº§åŸŸåï¼Œ `hao123` æ˜¯äºŒçº§åŸŸåï¼Œ `www` æ˜¯ä¸‰çº§åŸŸåã€‚

`DNS` è§„å®šï¼ŒåŸŸåä¸­çš„æ ‡å·ç”± `number` å’Œ `letter` ç»„æˆï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œæ¯ä¸ªæ ‡å·ä¸è¶…è¿‡ `63` ä¸ªå­—ç¬¦ï¼Œæ€»å‚ä¸è¶…è¿‡ `155` ä¸ªå­—ç¬¦ã€‚æ ‡å·ä¸­ï¼Œé™¤äº† `-` ä»¥å¤–ï¼Œä¸èƒ½å«æœ‰å…¶ä»–æ ‡ç‚¹ã€‚

å„çº§åŸŸåç”±å…¶ä¸Šä¸€çº§çš„*åŸŸåç®¡ç†æœºæ„*ç®¡ç†ï¼Œæœ€é«˜çš„é¡¶çº§åŸŸåç”±`ICANN`è¿›è¡Œç®¡ç†ã€‚

## é¡¶çº§åŸŸåTLD
`é¡¶çº§åŸŸåï¼ŒTLDï¼ŒTop Level Domain`åˆ†ä¸ºä¸‰å¤§ç±»ï¼š
1. å›½å®¶é¡¶çº§åŸŸå `nTLD` ï¼šæ¯”å¦‚cnä¸­å›½ï¼Œusç¾å›½ç­‰ã€‚
2. é€šç”¨é¡¶çº§åŸŸå `gTLD` ï¼šæ¯”å¦‚comæœæ–¯ä¼ä¸šï¼Œnetç½‘ç»œæœåŠ¡æœºæ„ï¼Œeduæ•™è‚²ç­‰ã€‚
3. åŸºç¡€ç»“æ„åŸŸåï¼š è¿™ç§é¡¶çº§åŸŸååªæœ‰ä¸€ä¸ª: `arpa` ï¼Œç”¨äºåå‘åŸŸåè§£æï¼Œå› æ­¤åˆç§°ä¸ºåå‘åŸŸåã€‚

> äº’è”ç½‘çš„åŸŸåç³»ç»Ÿæ˜¯æŒ‰ç…§æœºæ„ç»„ç»‡æ¥åˆ’åˆ†çš„ï¼Œå’Œç‰©ç†çš„ç½‘ç»œã€`IP`åœ°å€çš„å­ç½‘éƒ½æ²¡å…³ç³»ã€‚

# åŸŸåæœåŠ¡å™¨
ä¸€ä¸ªåŸŸåæœåŠ¡å™¨æ‰€è´Ÿè´£ç®¡è¾–çš„èŒƒå›´å«åš`åŒº`ã€‚å„ä¸ªå•ä½è§†å…·ä½“æƒ…å†µæ¥åˆ’åˆ†è‡ªå·±çš„åŒºï¼Œä¸€ä¸ªåŒºä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å¿…é¡»æ˜¯èƒ½å¤Ÿè¿é€šçš„ã€‚æ¯ä¸€ä¸ªåŒºè®¾ç½®ç›¸åº”çš„`æƒé™åŸŸåæœåŠ¡å™¨`ï¼Œç”¨æ¥ä¿å­˜è¯¥åŒºä¸­çš„æ‰€æœ‰ä¸»æœºçš„åŸŸååˆ° `IP` çš„æ˜ å°„ã€‚
> æ€»ä¹‹ï¼ŒåŒºæ˜¯ `DNS` æœåŠ¡å™¨å®é™…ç®¡è¾–çš„èŒƒå›´ã€‚

æ¯ä¸€ä¸ªåŸŸåæœåŠ¡å™¨éƒ½åªå¯¹åŸŸåä½“ç³»ä¸­çš„ä¸€éƒ¨åˆ†è¿›è¡Œç®¡è¾–ã€‚æ ¹æ®åŸŸåæœåŠ¡å™¨æ‰€èµ·çš„ä½œç”¨ï¼Œå¯ä»¥å°†åŸŸåæœåŠ¡å™¨åˆ†ä¸ºä»¥ä¸‹å››ç§ä¸åŒçš„ç±»å‹ï¼š
1. æ ¹åŸŸåæœåŠ¡å™¨ï¼šæ‰€æœ‰çš„æ ¹åŸŸåæœåŠ¡å™¨éƒ½çŸ¥é“é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åŸŸåå’Œå¯¹åº”çš„ `IP` åœ°å€ã€‚å®ƒæ˜¯æœ€é‡è¦çš„åŸŸåæœåŠ¡å™¨ï¼Œåªè¦æœ¬åœ°æœåŠ¡å™¨æ— æ³•è§£æåŸŸåï¼Œå°±é¦–å…ˆæ±‚åŠ©äºæ ¹åŸŸåæœåŠ¡å™¨ã€‚å¦‚æœæ ¹åŸŸåæœåŠ¡å™¨æŒ‚äº†ï¼Œé‚£æ•´ä¸ªäº’è”ç½‘çš„ `DNS` è‚¯å®šä¹Ÿå°±æŒ‚äº†ã€‚å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ ¹åŸŸåæœåŠ¡å™¨åªæ˜¯å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸‹ä¸€æ­¥åº”è¯¥æ‰¾å“ªä¸€ä¸ªé¡¶çº§åŸŸåæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œå¹¶ä¸ç›´æ¥è¿”å›IPã€‚
> æ ¹åŸŸåæœåŠ¡å™¨é‡‡ç”¨ä»»æ’­æŠ€æœ¯ï¼Œ`DNS client` å‘æŸä¸ªæ ¹åŸŸåæœåŠ¡å™¨å‘é€æŸ¥è¯¢æŠ¥æ–‡æ—¶ï¼Œè·¯ç”±å™¨èƒ½å¤Ÿæ‰¾åˆ°é‡Œè¿™ä¸ª `DNS client` æœ€è¿‘çš„ä¸€ä¸ªæ ¹åŸŸåæœåŠ¡å™¨ï¼Œå¹¶ä¸”åªäº¤ä»˜ç»™è¿™ä¸ªæœ€è¿‘çš„ã€‚
>> ä»»æ’­å°±æ˜¯å‘é€ç»™ä¸€ç»„ç›¸åŒ `ip` ï¼Œä¸åŒåœ°ç‚¹çš„ä¸»æœºæŠ¥æ–‡ï¼Œä½†æ˜¯åªäº¤ä»˜ç»™ç¦»æºç‚¹æœ€è¿‘çš„ä¸€å°ã€‚
2.  é¡¶çº§åŸŸåæœåŠ¡å™¨ (`TLD`æœåŠ¡å™¨)ï¼šè¿™äº›æœåŠ¡å™¨è´Ÿè´£ç®¡ç†åœ¨è¯¥é¡¶çº§åŸŸåæœåŠ¡å™¨ä¸‹æ³¨å†Œçš„æ‰€æœ‰äºŒçº§åŸŸåã€‚æ¯”å¦‚`com`ä¼šç®¡ç†è¯¸å¦‚`hao123.com`è¿™ç§ã€‚åœ¨æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œæœ‰å¯èƒ½ç»™å‡ºæœ€åçš„ç»“æœï¼Œä¹Ÿæœ‰å¯èƒ½ç»™å‡ºä¸‹ä¸€æ­¥åº”è¯¥æŸ¥æ‰¾çš„åŸŸåæœåŠ¡å™¨çš„`IP`ã€‚
3. æƒé™åŸŸåæœåŠ¡å™¨ï¼šä¹Ÿå°±æ˜¯å‰é¢æåˆ°çš„è´Ÿè´£åŒºçš„åŸŸåæœåŠ¡å™¨ã€‚å½“ä¸€ä¸ªæƒé™åŸŸåæœåŠ¡å™¨è¿˜æ— æ³•è§£æåŸŸåæ—¶ï¼Œå°±ä¼šå‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸‹ä¸€æ­¥åº”è¯¥æ‰¾å“ªä¸ªæƒé™åŸŸåæœåŠ¡å™¨ã€‚
4. æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼šå½“ä¸€å°ä¸»æœºå‘é€`DNS`æŸ¥è¯¢è¯·æ±‚æ—¶ï¼Œå°±ä¼šå‘é€ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨ã€‚å½“æ‰€è¦æŸ¥è¯¢çš„åŸŸåå±äºåŒä¸€`ISP`ä¸‹ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨å°±ä¼šç«‹å³å°†æ‰€æŸ¥è¯¢çš„ä¸»æœºåè½¬æ¢ä¸º`IP`ï¼Œè€Œä¸éœ€è¦å†å»è¯¢é—®å…¶ä»–çš„åŸŸåæœåŠ¡å™¨äº†ã€‚
> ä¸ºäº†æé«˜åŸŸåæœåŠ¡å™¨çš„å¯é æ€§ï¼Œ`DNS`æœåŠ¡å™¨ä¼šå°†æ•°æ®å¤åˆ¶åˆ°å¤šä¸ªæœåŠ¡å™¨æ¥ä¿å­˜ï¼Œä¸€ä¸ªä¸»åŸŸåæœåŠ¡å™¨ï¼Œå¤šä¸ªè¾…åŠ©åŸŸåæœåŠ¡å™¨ã€‚åªæœ‰ä¸»åŸŸåæœ‰æ”¹å˜æ•°æ®çš„æƒé™ï¼Œè¿™æ ·å°±ä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§ï¼Œè€Œä¸”å½“ä¸»åŸŸåæœåŠ¡å™¨å‡ºç°æ•…éšœçš„æ—¶å€™ï¼Œå‰¯ä¸»åŸŸåæœåŠ¡å™¨å°±èƒ½ä¿è¯`DNS`çš„æŸ¥è¯¢å·¥ä½œæ­£å¸¸è¿›è¡Œã€‚

# DNSè§£æè¿‡ç¨‹
è®¨è®ºå…·ä½“çš„è§£æè¿‡ç¨‹ä¹‹å‰å‘¢ï¼Œå…ˆè¯´ä¸¤ç‚¹ï¼š
1. ä¸»æœºå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨çš„æŸ¥è¯¢æ˜¯**é€’å½’æŸ¥è¯¢**ã€‚å°±æ˜¯æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸èƒ½è§£æçš„æ—¶å€™ï¼Œå®ƒä¼šè‡ªå·±ä½œä¸º`DNS client`å»å‘æ ¹åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè€Œä¸ç”¨è®©ä¸»æœºè‡ªå·±å»å‘é€è¯·æ±‚ã€‚
2. æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨çš„æŸ¥è¯¢æ˜¯**è¿­ä»£æŸ¥è¯¢**ã€‚å°±æ˜¯å½“æ ¹åŸŸåæœåŠ¡å™¨ä¸èƒ½ç›´æ¥å¾—åˆ°å¯¹åº”çš„`ip`æ—¶ï¼Œä¼šè¿”å›ä¸‹ä¸€æ­¥åº”å½“æŸ¥è¯¢çš„åŸŸåæœåŠ¡å™¨çš„`ip`ï¼Œè€Œè®©æœ¬åœ°åŸŸåæœåŠ¡å™¨ç»§ç»­å‘é€è¯·æ±‚ã€‚
> æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¹Ÿèƒ½é‡‡ç”¨é€’å½’æŸ¥è¯¢ï¼Œè¿™å–å†³äºæœ€åˆçš„æŸ¥è¯¢è¯·æ±‚è®¾ç½®çš„æ˜¯è¦æ±‚ä½¿ç”¨å“ªä¸€ç§æŸ¥è¯¢æ–¹å¼ã€‚

å‡å¦‚åŸŸåä¸º`m.xyz.com`çš„ä¸»æœºè¦æŸ¥è¯¢`y.abc.com`çš„IPï¼Œæ­¥éª¤ä¸ºï¼š
1.  ä¸»æœº`m.xyz.com`å…ˆå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨`dns.xyz.com`è¿›è¡Œé€’å½’æŸ¥è¯¢
2.  æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘ç°è‡ªå·±æ— æ³•ç›´æ¥å¾—å‡º`y.abc.com`çš„IPï¼Œç„¶åè‡ªå·±ä½œä¸º`DNS client`è¿­ä»£æŸ¥è¯¢ã€‚å…ˆå‘æ ¹åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ã€‚
3.  æ ¹åŸŸåæœåŠ¡å™¨å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œä¸‹ä¸€æ¬¡åº”è¯¥å»æŸ¥è¯¢çš„é¡¶çº§åŸŸåæœåŠ¡å™¨`dns.com`çš„`IP`
4.  æœ¬åœ°åŸŸåæœåŠ¡å™¨å†å‘`dns.com`å‘é€ `DNS` æŸ¥è¯¢è¯·æ±‚
5.  é¡¶çº§åŸŸåæœåŠ¡å™¨`dns.com`è¿”å›ä¸‹ä¸€æ¬¡åº”è¯¥æŸ¥è¯¢çš„æƒé™åŸŸåæœåŠ¡å™¨`dns.abc.com`çš„ip
6.  æœ¬åœ°åŸŸåæœåŠ¡å™¨å†å‘`dns.abc.com`å‘é€ `DNS` æŸ¥è¯¢è¯·æ±‚
7.  æƒé™åŸŸåæœåŠ¡å™¨`dns.abc.com`å¦‚æœèƒ½å¤Ÿç›´æ¥è§£ææ­¤åŸŸåå°±è¿”å›å¯¹åº”çš„`IP`ï¼Œå¦åˆ™ç»§ç»­è¿”å›ä¸‹ä¸€æ­¥åº”è¯¥æŸ¥è¯¢çš„å¦ä¸€å°æƒé™åŸŸåæœåŠ¡å™¨ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨é‡å¤ä¸Šè¿°æ“ä½œæœ€ç»ˆå¾—åˆ°`ip`
8.  æœ¬åœ°åŸŸåå¾—åˆ°`ip`åæŠŠæŸ¥è¯¢ç»“æœå‘Šè¯‰ä¸»æœº`m.abc.com`
> ä¸ç®¡æœ¬åœ°åŸŸåæœåŠ¡å™¨é‡‡ç”¨è¿­ä»£æŸ¥è¯¢è¿˜æ˜¯é€’å½’æŸ¥è¯¢ï¼Œæœ€ç»ˆå‘é€çš„`UDP`è¯·æ±‚æ•°æ€»é‡éƒ½æ˜¯ä¸€æ ·çš„ã€‚

# é«˜é€Ÿç¼“å­˜
ä¸ºäº†æé«˜`DNS`æŸ¥è¯¢æ•ˆç‡ã€å‡è½»äº’è”ç½‘ä¸Šçš„`DNS`æŸ¥è¯¢æŠ¥æ–‡æ•°é‡ï¼Œåœ¨åŸŸåæœåŠ¡å™¨ä¸­å¹¿æ³›ä½¿ç”¨äº†**é«˜é€Ÿç¼“å­˜**ï¼Œåˆç§°é«˜é€Ÿç¼“å­˜åŸŸåæœåŠ¡å™¨ã€‚

é«˜é€Ÿç¼“å­˜æ˜¯ç”¨æ¥å­˜å‚¨æœ€è¿‘æŸ¥è¯¢è¿‡çš„åŸŸåï¼Œä»¥åŠå¯¹åº”çš„`IP`ã€‚è¿˜æœ‰ä»å“ªé‡Œè·å¾—åŸŸåæ˜ å°„ä¿¡æ¯çš„è®°å½•ç­‰ã€‚

å¦‚æœåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼Œå‘ç°ä¸ä¹…å‰å·²ç»æŸ¥è¯¢è¿‡äº†åŸŸåä¸º`y.bac.com`çš„`ip`ï¼Œåˆ™æœ¬åœ°åŸŸåæœåŠ¡æ ¹æœ¬ä¸éœ€è¦å‘æ ¹åŸŸåæœåŠ¡å™¨å‘é€`DNS` æŸ¥è¯¢è¯·æ±‚ï¼Œç›´æ¥ä»é«˜é€Ÿç¼“å­˜ä¸­å¾—åˆ°`IP`è¿”å›ç»™ä¸»æœºå³å¯ã€‚

è€Œä¸”ï¼Œå°±ç®—ä¸èƒ½ç›´æ¥å¾—åˆ°å¯¹åº”çš„`ip`ï¼Œå¦‚æœæœ‰ç›¸åŒé¡¶çº§åŸŸåæœåŠ¡å™¨çš„`IP`ï¼Œå°±ç›´æ¥å‘é¡¶çº§åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚å°±è¡Œäº†ï¼Œå°±ä¸å¿…å‘æ ¹åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚äº†ï¼ˆæ‰€ä»¥ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸ä¸€å®šä¼šå‘æ ¹åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚å“¦ğŸ˜¯ï¼‰ã€‚

è¿™æ ·ï¼Œä¸è¿›å¯ä»¥å¤§å¤§å‡è½»æ ¹åŸŸåæœåŠ¡å™¨çš„è´Ÿæ‹…ï¼Œè€Œä¸”è®©äº’è”ç½‘æ€»`DNS`æŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡çš„æ•°é‡å¤§å¤§å‡å°‘ã€‚

## è¿‡æœŸæ—¶é—´
å› ä¸ºåŸŸååˆ°`ip` çš„æ˜ å°„ä¸ç»å¸¸æ”¹å˜ï¼Œä½†æ˜¯ä¹Ÿæ˜¯ä¼šå˜çš„ã€‚æ‰€ä»¥ä¸ºäº†ä¿æŒé«˜é€Ÿç¼“å­˜çš„æ­£ç¡®æ€§ï¼Œå¿…é¡»è®¾ç½®è®¡æ—¶å™¨å¤„ç†è¶…è¿‡åˆç†æ—¶é—´çš„é¡¹ï¼ˆä¾‹å¦‚æ¯ä¸ª`item` å¼„`2`å¤©ï¼‰ã€‚è¿‡æœŸå°±è¦é‡æ–°å»å‘é€`DNS`æŸ¥è¯¢è¯·æ±‚ã€‚

åœ¨æƒé™æœåŠ¡å™¨è¿”å›`ip`æ—¶ï¼Œä¹Ÿè¦æŒ‡æ˜ç»‘å®šçš„æœ‰æ•ˆæ—¶é—´å€¼ã€‚

## ä¸»æœºä¸­çš„ç¼“å­˜
å…¶å®é™¤äº†åŸŸåæœåŠ¡å™¨æœ‰ç¼“å­˜å¤–ï¼Œä¸»æœºä¹Ÿæ˜¯éœ€è¦é«˜é€Ÿç¼“å­˜çš„ã€‚

è®¸å¤šä¸»æœºåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šå°†æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸‹è½½æ‰€æœ‰çš„`åŸŸå-ip`ï¼Œç»´æŠ¤å­˜æ”¾è‡ªå·±æœ€è¿‘ä½¿ç”¨çš„åŸŸåçš„é«˜é€Ÿç¼“å­˜ï¼Œå¹¶ä¸”åªæœ‰ä»ç¼“å­˜ä¸­æ‰¾ä¸åˆ°çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨åŸŸåæœåŠ¡å™¨ã€‚
> ç»´æŠ¤æœ¬åœ°åŸŸåæœåŠ¡å™¨çš„ä¸»æœºè‚¯å®šè¦å®šæœŸæ£€æŸ¥åŸŸåæœåŠ¡å™¨ï¼Œè·å–æœ€æ–°çš„æ˜ å°„ä¿¡æ¯ï¼Œè€Œä¸”å¿…é¡»è¦å¹²æ‰æ— æ•ˆçš„`item`ã€‚å› ä¸º`åŸŸå-ip`çš„ç»‘å®šæ”¹åŠ¨å¹¶ä¸é¢‘ç¹ï¼Œæ‰€ä»¥ä¸éœ€è¦å¤ªå¤šçš„ç²¾åŠ›å°±èƒ½ç»´æŠ¤æ•°æ®åº“çš„ä¸€è‡´æ€§ğŸ˜ºã€‚

# DNSçš„è¯·æ±‚æŠ¥æ–‡
å¦‚æœæ‰“å°å‡ºæ¥DNSçš„è¯·æ±‚messageï¼š
```
<Buffer a2 f5 01 00 00 01 00 00 00 00 00 00 05 66 61 6e 79 69 08 62 64 73 74 61 74 69 63 03 63 6f 6d 00 00 01 00 01>
```

å‰12ä¸ªbyteæ˜¯é¦–éƒ¨ï¼Œåé¢çš„æ˜¯æ•°æ®éƒ¨åˆ†ã€‚

## ä»æ•°æ®å­—æ®µä¸­æå–åŸŸå
![](https://user-gold-cdn.xitu.io/2019/4/27/16a5da56ae121c55?w=1318&h=246&f=png&s=24622)
```js
server.on('message', msg => {
  // è¿™é‡Œçš„msgå°±æ˜¯DNSçš„è¯·æ±‚æŠ¥æ–‡
  // å»æ‰é¦–éƒ¨
  parseDomain(msg.slice(12));
});

function parseDomain(msg) {
  let doamin = '';
  let offset = 1;
  let num = msg[0];
  while(num) {
    domain += msg.slice(offset, offset + num).toString();
    offset += num;
    num = msg[offset];
    offset ++;
    if (num) domain += '.';
  }
  return domain;
}
```

# DNSå“åº”æŠ¥æ–‡
```
<Buffer e2 91 81 80 00 01 00 00 00 00 0
0 00 11 77 61 77 73 2d 70 72 6f 64 2d 6
2 61 79 2d 31 30 39 08 63 6c 6f 75 64 6
1 70 70 03 6e 65 74 00 00 1c 00 01>
```

# å‚è€ƒ
[NodeJSç¼–å†™ç®€å•çš„DNSæœåŠ¡å™¨](https://www.jianshu.com/p/8cdcbae986a8)