# ç®€ä»‹
`@babel/preset-env`æ˜¯ä¸€ä¸ªæ™ºèƒ½é¢„è®¾ï¼Œå…è®¸ä½¿ç”¨æœ€æ–°çš„`JavaScript`ï¼Œè€Œä¸éœ€è¦å…³æ³¨ä½ çš„ç›®æ ‡ç¯å¢ƒéœ€è¦å“ªäº›è¯­æ³•è½¬æ¢ï¼ˆä»¥åŠå¯é€‰çš„æµè§ˆå™¨`polyfill`ï¼‰ï¼Œå› ä¸ºè¿™äº›äº‹æƒ…`@babel/preset-env`éƒ½è‡ªåŠ¨åœ°å¸®ä½ å®Œæˆäº†ï¼Œä¸ä»…å¦‚æ­¤ï¼Œç”±äºè¿™äº›ä¼˜ç‚¹è¿˜ä»¤`JavaScript`çš„`bundle`æ›´å°ã€‚

> å…¶å®presetä¹Ÿç®—æ˜¯pluginï¼Œåªä¸è¿‡å…³äºES2015+çš„æ–°ç‰¹æ€§å¯¹åº”çš„æ’ä»¶å¤ªå¤šäº†ï¼Œbabelå®˜æ–¹å°†è¿™äº›æ–°ç‰¹æ€§å…¨éƒ¨éƒ½å¼„åˆ°ä¸€èµ·å°±æˆäº†presetçš„preset-es2015+äº†ã€‚é‚£ä»Šå¤©è¦è¯´çš„è¿™ä¸ª@babel/preset-envä¹Ÿæ˜¯ä¸€ä¸ªé“ç†ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯æ’ä»¶ï¼Œå¯ä»¥ç†è§£ä¸ºé›†æˆçš„æ’ä»¶é›†åˆã€‚

## èƒŒæ™¯
æœ€åˆä¸ºäº†èƒ½å¤Ÿè®©å¼€å‘è€…æ—©ç‚¹ç”¨ä¸Šæ–°jsç‰¹æ€§ï¼Œè€Œä¸å¿…ç­‰åˆ°ä¸»æµæµè§ˆå™¨æ”¯æŒï¼Œbabelå›¢é˜Ÿå¼€å‘äº†`babel-preset-latest`ï¼Œå®ƒæ˜¯å¤šä¸ªpresetçš„é›†åˆ(ES2015+)ï¼Œéšç€ECMAçš„è§„èŒƒæ›´æ–°è€Œæ›´æ–°ã€‚

ä½†æ˜¯å¦‚æœç…§ç€è¿™æ ·ä¸‹å»æ’ä»¶ä¼šè¶Šæ¥è¶Šå¤šï¼Œç¼–è¯‘çš„é€Ÿåº¦ä¼šå˜çš„éå¸¸æ…¢ï¼›ä¸æ­¤åŒæ—¶æµè§ˆå™¨çš„æ”¯æŒåº¦ä¹Ÿè¶Šæ¥è¶Šé«˜ï¼Œç¼–è¯‘åˆ°ä½ç‰ˆæœ¬çš„å¿…è¦æ€§å‡å°‘ã€‚

ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œbabelå®˜æ–¹åˆæ¨å‡ºäº†`babel-preset-env`æ’ä»¶ï¼Œä»–å¯ä»¥gunå±€å¼€å‘è€…çš„éœ€è¦ï¼ˆé…ç½®ï¼‰æ¥æŒ‰éœ€åŠ è½½æ’ä»¶ï¼Œæ¯”å¦‚ï¼š
+ éœ€è¦æ”¯æŒçš„å¹³å°
+ å¹³å°çš„ç‰ˆæœ¬ç­‰

> åœ¨æ²¡æœ‰ä»»ä½•é…ç½®é€‰é¡¹çš„æƒ…å†µä¸‹ï¼Œ`@babel/preset-env` ä¸ `@babel/preset-latest`ï¼ˆæˆ–è€…`@babel/preset-es2015ï¼Œ@babel/preset-es2016å’Œ@babel/preset-es2017ä¸€èµ·`ï¼‰çš„è¡Œä¸ºå®Œå…¨ç›¸åŒã€‚æ‰€ä»¥ä»–ä»¬å°±å…¨éƒ¨éƒ½è¢«`@babel/preset-env`æ·˜æ±°äº†ã€‚

# å®‰è£…
```shell
npm install -D @babel/preset-env    # babel7
npm install -D babel-preset-env     # babel6, ä»¥ä¸‹æ²¡æœ‰ç‰¹æ®Šè¯´æ˜éƒ½ä½¿ç”¨babel7
```

# ä½¿ç”¨
```json
{
  "presets": [
    ["@babel/preset-env", {
      "targets": {
        "browsers": "name version",
      },
      "useBuiltIns": "entry"
    }],
  ]
}
```

## targets
`string | Array<string> | { [string]: string }`, é»˜è®¤ä¸º`{}`ã€‚
ç”¨äºæè¿°é¡¹ç›®çš„ç›®æ ‡ç¯å¢ƒã€‚
### æ”¯æŒç‰¹å®šç‰ˆæœ¬çš„æµè§ˆå™¨
å¦‚æœåªéœ€è¦æ”¯æŒæŸä¸ªç‰ˆæœ¬ï¼Œæ¯”å¦‚Chrome 63ï¼Œé…ç½®å°±å¯ä»¥è¿™ä¹ˆå†™ï¼š
```json
{
  "presets": [
    ["@babel/preset-env", {
      "targets": "chrome 63",
    }],
  ]
}
```
### æ”¯æŒç‰¹å®šèŒƒå›´çš„æµè§ˆå™¨
å¤§éƒ¨åˆ†çš„æ—¶å€™æˆ‘ä»¬éœ€è¦é’ˆå¯¹çš„éƒ½æ˜¯ç‰¹å®šèŒƒå›´çš„æµè§ˆå™¨ï¼Œæ¯”å¦‚IE8+,è¿™ä¸ªæ—¶å€™é…ç½®ï¼š
```json
{
  "presets": [
    ["@babel/preset-env", {
      "targets": "ie >= 8",
    }]
  ]
}
```
### æ”¯æŒå¤šç§æµè§ˆå™¨
```json
{
  "presets": [
    ["@babel/preset-env", {
      "targets": ["ie >= 8", "chrome >= 63"]
    }]
  ]
}
```
æˆ–è€…
```json
{
  "presets": [
    ["@babel/preset-env", {
      "targets": {
        "chrome": "63",
        "ie": "8",
      }
    }]
  ]
}
```

### targets.esmodules
è¿˜å¯ä»¥ç›´æ¥å®šä½`æ”¯æŒES6æ¨¡å—`çš„æµè§ˆå™¨ï¼š
```json
{
  "presets": [
    ["@babel/preset-env", {
      "targets": {
        "esmodules": true,
      }
    }]
  ]
}
```
> è¿™ä¸ªæ—¶å€™ä¼šå¿½ç•¥æ‰targetsçš„å…³äºæµè§ˆå™¨çš„å…¶ä»–é€‰é¡¹ã€‚

### targets.node
`string | "current" | true`
ä»¥ä¸Šéƒ½æ˜¯é’ˆå¯¹æµè§ˆå™¨çš„ï¼Œå¦‚æœç›®æ ‡ç¯å¢ƒæ˜¯nodeï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ï¼š
```js
{
  "presets": [
    ["@babel/preset-env", {
      "targets": {
        "node": "current",
      }
    }]
  ]
}
```
> `currentã€true`éƒ½ä»–å¨˜çš„æŒ‡çš„æ˜¯`process.version.node`

> `@babel/preset-env`å€ŸåŠ©äº†[browserslist](https://github.com/browserslist/browserslist)è¿™ä¸ªåº“ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®štargetsï¼Œ`@babel/preset-env`ä¼šè½¬æ¢æ‰€æœ‰ES2015+çš„ä»£ç ã€‚


## useBuiltIns
`"usage" | "entry" | false`, é»˜è®¤ä¸ºfalse
ä¸€ç§å°†`polyfill`åº”ç”¨äº`@babel/preset-env`ä¸­çš„æ–¹æ³•ã€‚

é»˜è®¤ä¸ºfalseï¼Œæ„ä¸ºä¸å¯¹polyfillåšå¤„ç†ã€‚
> è¿™ç§æ–¹å¼ä¸ä¼šåƒæ™®é€šçš„`babel-polyfill`é‚£æ ·çš„å®éªŒæ€§`polyfill/stage-x`å†…ç½®æ’ä»¶ã€‚

### entry
ä¼šæŠŠ`@babel/polyfill`åˆ†æˆå¥½å¤šå°å—å¼•å…¥ã€‚æ–‡æ¡£ä¸Šè¯´åœ¨é¡¹ç›®å…¥å£å¼•å…¥ä¸€æ¬¡å¤šæ¬¡å¼•å…¥ä¼šæŠ¥é”™ï¼ˆä½†æ˜¯æˆ‘å¤šæ¬¡å¼•å…¥ä¹Ÿæ²¡ğŸ¤—âŒå•Šï¼Ÿï¼Ÿï¼‰

æ’ä»¶`@babel/preset-env`ä¼šå°†æŠŠ`@babel/polyfill`æ ¹æ®å®é™…éœ€æ±‚æ‰“æ•£ï¼Œåªç•™ä¸‹å¿…é¡»çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šæ ¹æ®ä½ çš„targetsé…ç½®æ¥åˆ¤æ–­ã€‚

### usage
è·Ÿä¸Šé¢çš„ä¸åŒï¼Œè¿™ä¸ªé€‰é¡¹æ›´åŠ æ™ºèƒ½ï¼Œå®ƒä¼šåˆ¤æ–­æ¯ä¸ªæ–‡ä»¶ç”¨åˆ°äº†å“ªäº›æ–°ç‰¹æ€§ï¼Œå¦‚æœéœ€è¦æ·»åŠ `polyfill`åˆ™å¼•å…¥ï¼Œå¦åˆ™ä¸å¼•å…¥ã€‚ä½“ç§¯æ›´å°ã€‚

## include
`Array<string>`ï¼Œé»˜è®¤ä¸º[]

å¦‚æœåŸç”Ÿçš„ç¯å¢ƒæœ‰ä¸ªbugï¼Œæˆ–è€…ä¸æ”¯æŒçš„åŠŸèƒ½ä¸æ”¯æŒçš„åŠŸèƒ½çš„ç»„åˆä¸èµ·ä½œç”¨ï¼Œè¿™ä¸ªé€‰é¡¹å°†ä¼šæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œ <br>
`Node 4` æ”¯æŒåŸç”Ÿç±»ä½†ä¸æ”¯æŒç±»æ‰©å±•ã€‚å¦‚æœ `super` ä¸æ‰©å±•å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œé‚£ä¹ˆéœ€è¦ `include` é€‰é¡¹ `transform-es2015-classes` å› ä¸ºå¦‚æœä¸æ˜¯ä»¥ `super` æ–¹å¼è¿›è¡Œä¼ æ’­ï¼Œåˆ™ä¸å¯èƒ½è¿›è¡Œè½¬è¯‘ã€‚

## exclude
`Array<string>`ï¼Œé»˜è®¤ä¸º[]ï¼Œæ€»æ˜¯ç§»å‡ºçš„æ’ä»¶ï¼Œå–å€¼å’Œincludeç›¸åŒ

å½“ä½¿ç”¨useBuiltInsæ—¶ï¼Œå¯ä»¥åŒ…å«ä¸é€‚ç”¨çš„æ’ä»¶ï¼Œè¿™æ ·åœ¨è½¬è¯‘çš„æ—¶å€™å°±ä¸ä¼šå¯¹è¿™äº›ä¸œè¥¿è¿›è¡Œè½¬è¯‘äº†ã€‚

> includeå’Œexcludeåªé€‚ç”¨äºpresetä¸­åŒ…å«çš„æ’ä»¶ï¼Œå¦‚æœè¦ä½¿ç”¨å…¶ä»–æ’ä»¶è¯·ç›´æ¥æ·»åŠ åˆ°configä¸­ã€‚

## modules
è¿™ä¸ªæœ¬æ¥æ˜¯ç”¨æ¥å°†ä»£ç è½¬æ¢æˆä¸åŒçš„æ¨¡å—æœºåˆ¶çš„ï¼Œä½†æ˜¯webpackå·²ç»æŠŠè¿™ä»¶äº‹æƒ…åšäº†ï¼Œæ‰€ä»¥babelå°±ä¸éœ€è¦åšäº†ï¼Œä½†æ˜¯æœ‰å¯èƒ½ä¼šæœ‰å†²çªï¼Œå› ä¸ºmodulesé»˜è®¤ä¸ºcommonjsï¼Œå¦‚æœæœ‰å†²çªï¼Œéœ€è¦æ‰‹åŠ¨å°†modulesè®¾ç½®ä¸ºfalseã€‚

# @babel/preset-envå®ç°åŸç†
1.  ä½¿ç”¨[compat-tabe](https://github.com/kangax/compat-table)æ¥ç¡®å®šæµè§ˆå™¨çš„æ”¯æŒæƒ…å†µ
2.  å°†jsçš„æ–°ç‰¹æ€§è·Ÿç‰¹å®šçš„babelæ’ä»¶å»ºç«‹[æ˜ å°„å…³ç³»](https://github.com/babel/babel-preset-env/blob/master/data/plugin-features.js)(ä¸åŒ…æ‹¬stage-x)
3.  æ ¹æ®å¼€å‘è€…çš„é…ç½®æ¥ç¡®å®šè‡³å°‘è¦åŒ…å«å“ªäº›æ’ä»¶ã€‚

# æ€»ç»“
å…¶ä»–çš„ä¸€äº›å‚æ•°è¯·çœ‹[æ–‡æ¡£](https://www.babeljs.cn/docs/plugins/preset-env/)